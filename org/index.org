#+TITLE: Установка и использование пакета ModEM
#+OPTIONS: toc:nil H:6 num:nil html-postamble:nil ^:nil tags:nil author:nil
#+SETUPFILE: theme-readtheorg-local.setup
#+HTML_HEAD: <style type="text/css">.org-src-name{ text-align: right; }</style>
#+HTML_HEAD: <style type="text/css">.outline-2{ margin-top: 60px; }</style>

В настоящее время установка осуществляется с помощью *modem.tar.gz*. Доступ к [[http://blogs.oregonstate.edu/modem3dmt/?page_id=123][серверу SVN]] и тестовые примеры отсутствуют. Без тестовых примеров предложить типичные варианты использования затруднительно.
#+begin_src sh :dir /ssh:boykov@mercury.febras.net:/home/boykov/install/ :exports results
ls
#+end_src

#+RESULTS:
: ModEM  modem_docs.tar.gz  modem.tar.gz

* Общие команды для всех установок <mkl-sse>
#+name: mkl-sse
#+begin_src sh :dir /ssh:boykov@mercury.febras.net:/home/boykov/install/ :exports code
sed -i "s|^LIBS_PATH = -L/opt/intel/Compiler/11.1/075/mkl/lib/em64t|LIBS_PATH = -L/opt/intel/mkl/10.2.5.035/lib/em64t|g" Makefile
sed -i "s|^LIBS = -llapack -lblas |LIBS = -lmkl_rt |g" Makefile
sed -i "s|^FFLAGS = -O3 -w  -xSSE4.2 -std03|FFLAGS = -O3 -w -std03|g" Makefile

make
#+end_src
* Установка 3D_MT MPI (Parallel)
#+begin_src sh :dir /ssh:boykov@mercury.febras.net:/home/boykov/install/ :exports code :noweb yes
tar xzvf modem.tar.gz
rm -rf ModEM/f90/objs/2D_MT
rm -rf ModEM/f90/objs/3D_MT
cd ModEM/f90
bash Configure.3D_MT.Intel Makefile MPI
sed -i "s/^F90 = ifort /F90 = mpiifort/g" Makefile
<mkl-sse>
cp Mod3DMT /opt/modem
#+end_src
* Установка 3D_MT Release (Sequential)
#+begin_src sh :dir /ssh:boykov@mercury.febras.net:/home/boykov/install/ :exports code :noweb yes
rm Makefile
rm -rf ModEM/f90/objs/3D_MT
bash Configure.3D_MT.Intel Makefile release
<mkl-sse>
cp Mod3DMT /opt/modem/Mod3DMT_seq
#+end_src
* Установка 2D_MT Release (Sequential)
#+begin_src sh :dir /ssh:boykov@mercury.febras.net:/home/boykov/install/ :exports code :noweb yes
rm Makefile
bash Configure.2D_MT.Intel Makefile release
<mkl-sse>
cp Mod2DMT /opt/modem/Mod2DMT_seq
#+end_src
* Установка 2D_MT MPI (Parallel)
MPI-версия не тестировалась (так сказано в README) и при сборке выдает ошибку. Похоже, в кодовой базе не прописаны какие-то пути:
#+begin_src raw
Couldn't find source file for module MPI_declaration
Couldn't find source file for module MPI_main
#+end_src
